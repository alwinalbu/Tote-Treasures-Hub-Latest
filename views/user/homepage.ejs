<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HomePage</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Font -->
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>
  <link href='https://fonts.googleapis.com/css?family=Italianno' rel='stylesheet'>

  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" type="text/css" href="/css/homepage.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/images/logo.png">
</head>

<body>
  <!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: black;">
  <div class="container-fluid d-flex justify-content-between align-items-center">

    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center" href="/homepage">
      <img src="/images/logo.png" style="max-height: 70px" alt="ToteTreasures Logo">
      <h3 class="text-white fw-bold m-0 ms-2">ToteTreasures Hub</h3>
    </a>

    <!-- Search (hidden on small screens) -->
    <form class="d-flex d-none d-lg-flex" role="search" action="/search" method="GET">
      <input class="form-control me-2" type="search" name="searchNames" placeholder="Search">
      <button class="btn btn-outline-success" type="submit">Search</button>
    </form>

    <!-- Mobile toggle -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Menu -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="/homepage">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="/shop">Shop</a></li>
        <li class="nav-item">
          <a class="nav-link" href="/wishlist">
            WishList <i class="fa-solid fa-heart text-danger"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/cartpage">
            Cart <i class="fa-solid fa-cart-shopping text-primary"></i>
            <% if (cartCount> 0) { %>
              <span id="cart-quantity" class="badge bg-danger">
                <%= cartCount %>
              </span>
              <% } %>
          </a>
        </li>
        <li class="nav-item ms-auto">
          <% if (user) { %>
            <div class="dropdown">
              <a href="#" class="dropdown-toggle nav-link" id="usernameLink" data-bs-toggle="dropdown">
                <%= user.username %> <i class="fa-solid fa-user"></i>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="/profile">Profile</a></li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li><a class="dropdown-item" href="/logout" id="logoutLink">Logout</a></li>
              </ul>
            </div>
            <% } else { %>
              <div class="d-flex align-items-center">
                <a class="nav-link" href="/signup"><i class="fa-solid fa-user-plus"></i> Sign Up</a>
                <span class="nav-link">|</span>
                <a class="nav-link" href="/login"><i class="fa-solid fa-sign-in-alt"></i> Login</a>
              </div>
              <% } %>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <!-- Carousel -->
  <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"></button>
    </div>
    <div class="carousel-inner">
      <div class="carousel-item active"><img src="/images/bag image 2.jpg" class="d-block w-100" alt="..."></div>
      <div class="carousel-item"><img src="/images/banner 2.jpg" class="d-block w-100" alt="..."></div>
      <div class="carousel-item"><img src="/images/banner 3.jpg" class="d-block w-100" alt="..."></div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
      data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
      data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>

  <!-- Content Section -->
  <section style="background-color: #000;">
    <!-- Video -->
    <div class="banner banner-1 container-fluid p-0">
      <video autoplay muted loop controls class="img-fluid" style="object-fit: cover; width: 100%; height:450px;">
        <source src="/video/wallet video.mp4" type="video/mp4">
      </video>
    </div>

    <!-- Categories -->
    <div class="text-center" style="background-color: #0f0f0f;">
      <h5 class="icons categories text-white">SHOP FOR</h5>
      <div class="container">
        <div class="row d-flex justify-content-center">
          <% categories.forEach(function(category) { %>
            <div class="col-6 col-md-4 col-lg-2 icons mb-4">
              <a href="/category/<%= category._id %>">
                <img style="width: 100%; height: 250px; object-fit: cover;" class="mx-2"
                  src="/uploads/<%= category.image %>" alt="Category Image">
              </a>
              <span style="color: white;">
                <%= category.Name %>
              </span>
            </div>
            <% }); %>
        </div>
      </div>
    </div>

    <!-- Products -->
    <div class="products container">
      <h2 class="text-center text-white my-4">New Arrivals</h2>
      <div class="row">
        <% products.forEach(function(product) { %>
          <div class="col-lg-4 col-xl-3 col-sm-6 mb-4">
            <div class="card position-relative h-100">
              <% if (product.offer) { %>
                <span class="badge badge-danger badge-circle position-absolute p-2" style="top: 0; left: 0;">
                  <%= product.offer.percentage %>%
                </span>
                <% } %>
                  <img src="/uploads/<%= product.images[0] %>" class="card-img-top"
                    style="height: 40vh; object-fit: cover;" alt="">
                  <div class="card-body d-flex flex-column justify-content-between">
                    <h5 class="card-title text-center text-truncate">
                      <%= product.ProductName %>
                    </h5>
                    <div class="text-center">
                      <% if (product.AvailableQuantity===0) { %>
                        <p class="bg-danger text-white p-2">Out of Stock</p>
                        <% } else if (product.offer) { %>
                          <p class="text-danger"><del>₹<%= product.Price %></del></p>
                          <p><span class="text-danger"><del>₹<%= product.DiscountAmount %></del></span>
                            <span class="text-success"> Offer Price ₹<%= product.offerPrice %></span>
                          </p>
                          <a href="/productViewDetailspage/<%= product._id %>" class="btn btn-primary">View Details</a>
                          <% } else { %>
                            <p class="text-danger"><del>₹<%= product.Price %></del></p>
                            <p class="text-success">Discount Price ₹<%= product.DiscountAmount %>
                            </p>
                            <a href="/productViewDetailspage/<%= product._id %>" class="btn btn-primary">View
                              Details</a>
                            <% } %>
                    </div>
                  </div>
            </div>
          </div>
          <% }); %>
      </div>

      <% if (products.length> 0) { %>
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-end">
            <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
              <a class="page-link" href="?page=<%= currentPage - 1 %>">Previous</a>
            </li>
            <% for (let i=1; i <=totalPages; i++) { %>
              <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                <a class="page-link" href="?page=<%= i %>">
                  <%= i %>
                </a>
              </li>
              <% } %>
                <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                  <a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a>
                </li>
          </ul>
        </nav>
        <% } else { %>
          <p class="text-white">No products found.</p>
          <% } %>
    </div>
  </section>

  <!-- Footer -->
  <%- include('../layouts/footer') %>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>